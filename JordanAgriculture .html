<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jordan Agriculture Stats - Comprehensive Data</title>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        /* üé® THEME VARIABLES - Dark Mode is the default */

        :root {
            /* Background Gradient Colors */
            --bg-dark: #253528; /* Start */
            --bg-medium: #49654E; /* Mid */
            --bg-light: #8BA889; /* End */

            /* Primary Colors */
            --text-color-main: #fff;
            --text-color-secondary: rgba(255, 255, 255, 0.85); /* p text */
            --accent-color: #A3C49B; /* Accent color, scrollbar, h4 */

            /* Glass/Box Colors */
            --box-bg: rgba(255, 255, 255, 0.12);
            --glass-border: rgba(255, 255, 255, 0.25);
            --shadow-color: rgba(0, 0, 0, 0.35);

            /* Button/Filter Colors */
            --button-bg: rgba(255, 255, 255, 0.1);
            --button-hover: rgba(255, 255, 255, 0.3);
            --filter-border: rgba(255, 255, 255, 0.2);
            --filter-active-border: var(--accent-color);

            /* Chart Colors (for borders and text inside charts) */
            --chart-text-color: rgba(255, 255, 255, 0.9);
            --chart-grid-color: rgba(255, 255, 255, 0.2);
            
            --border-radius: 14px;
        }

        /* Light Mode Overrides */
        .light-mode {
            /* Background Gradient Colors */
            --bg-dark: #f0f0f0;
            --bg-medium: #ffffff; 
            --bg-light: #e0e0e0; 

            /* Primary Colors */
            --text-color-main: #222222;
            --text-color-secondary: #555555;
            --accent-color: #49654E; /* Darker accent for contrast */

            /* Glass/Box Colors */
            --box-bg: rgba(255, 255, 255, 0.85); /* Less transparent for light mode */
            --glass-border: rgba(0, 0, 0, 0.1);
            --shadow-color: rgba(0, 0, 0, 0.15);

            /* Button/Filter Colors */
            --button-bg: rgba(0, 0, 0, 0.05);
            --button-hover: rgba(0, 0, 0, 0.15);
            --filter-border: rgba(0, 0, 0, 0.1);
            --filter-active-border: var(--accent-color);
            
            /* Chart Colors (for borders and text inside charts) */
            --chart-text-color: #444444;
            --chart-grid-color: rgba(0, 0, 0, 0.1);
        }

        body {
            margin: 0;
            font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
            
            /* Apply Theme Variables */
            color: var(--text-color-main);
            background: linear-gradient(135deg, var(--bg-dark) 5%, var(--bg-medium) 40%, var(--bg-light));
            
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow: hidden; 
            transition: background-color 0.5s ease;
        }
       
         #progress-bar {
            position: fixed;
            top: 0;
            left: 0;
            width: 0%;
            height: 6px;
            background: linear-gradient(to right, #82e77a, #000000);
            z-index: 1000;
            transition: width 0.3s ease;
        }
        /* ‚úÖ Controls Container for Fixed Buttons */
        .controls-container {
            padding-top: 10px;
            width: 95%;
            position: fixed;
            top: 15px;
            left: 15px;
            
            display: flex;
            justify-content: space-between;
       
            z-index: 1000;
        }

        /* ‚úÖ Back Button & Theme Toggle Base Style */
        .back-button, #theme-toggle {
            background: var(--button-bg);
            color: var(--text-color-main);
            border: 1px solid var(--glass-border);
            padding: 8px 14px;
            border-radius: var(--border-radius);
            font-size: 1rem;
            font-weight: 600;
            text-decoration: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: background 0.3s ease, border-color 0.3s ease, color 0.3s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }
        .back-button:hover, #theme-toggle:hover {
            background: var(--button-hover);
            transform: none; /* Override the transform on filter buttons */
        }

        /* ‚úÖ Main Container */
        .stats-container {
            background: var(--box-bg);
            border: 1px solid var(--glass-border);
            box-shadow: 0 8px 30px var(--shadow-color);
            
            /* Scrollbar styling */
            scrollbar-color: var(--accent-color) transparent;
            
            width: 95%;
            max-width: 900px;
            max-height: 95vh; 
            overflow-y: auto; 
            padding: 30px;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: var(--border-radius);
            text-align: center;
            margin: 0;
            scroll-behavior: smooth; 
        }

        .stats-container::-webkit-scrollbar-thumb {
            background: var(--accent-color);
        }

        /* üõë Filter Bar Styling üõë */
        .filter-bar {
            border-bottom: 1px solid var(--filter-border);
            display: flex;
            justify-content: center;
            padding-bottom: 15px;
            margin-bottom: 25px;
            gap: 15px;
            flex-wrap: wrap; 
        }
        
        .filter-button {
            background: var(--button-bg);
            color: var(--text-color-main);
            border: 1px solid var(--filter-border);
            padding: 8px 15px;
            border-radius: var(--border-radius);
            text-decoration: none;
            transition: background 0.3s ease, border-color 0.3s ease;
        }
        .filter-button:hover {
            background: var(--button-hover);
            border-color: var(--accent-color);
        }

        h1, h2, h3, h4 {
            color: var(--text-color-main); /* Ensure titles change color */
            text-shadow: 1px 1px 2px var(--shadow-color);
            transition: color 0.5s ease, text-shadow 0.5s ease;
        }
        h4 { 
            color: var(--accent-color); 
        }

        p {
            color: var(--text-color-secondary);
            transition: color 0.5s ease;
        }
        ul {
            list-style: none; /* Remove default bullets */
            padding: 0;
            margin: 20px 0;
            text-align: left;
        }
        li {
            padding: 5px 0;
            color: var(--text-color-secondary);
        }
        li strong {
            color: var(--accent-color); 
        }

        /* Styling for the introductory paragraph above each chart */
        .chart-description {
            background: rgba(0, 0, 0, 0.1);
            border-left: 4px solid var(--accent-color);
            transition: background 0.5s ease;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 var(--border-radius) var(--border-radius) 0;
            text-align: left;
        }
        .chart-description p {
            color: var(--text-color-secondary);
            margin: 0;
        }

        /* ‚úÖ Chart Sections */
        .chart-section {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 40px;
        }
        .chart-box {
            background: var(--box-bg); /* Use box-bg for chart box transparency */
            border: 1px solid var(--glass-border);
            box-shadow: 0 3px 12px var(--shadow-color);
            transition: background 0.5s ease, border-color 0.5s ease, box-shadow 0.5s ease;
            padding: 20px;
            border-radius: var(--border-radius);
            height: auto; /* Ensure chart has a minimum visible size */
            position: relative;
        }
        .text-summary {
            text-align: left;
            padding: 0 10px;
        }
        
        /* Ensure canvas scales correctly */
        .chart-box canvas {
            display: block;
            width: 100% !important; 
            height: 100% !important; 
        }
        
        /* ‚úÖ Responsiveness */
        @media (min-width: 768px) {
            .chart-section {
                flex-direction: row;
                align-items: center;
                text-align: left;
            }
            .chart-box {
                flex: 1;
                min-height: 400px;
                max-width: 50%; 
            }
            .text-summary {
                flex: 1;
                max-width: 50%;
                padding: 0 20px;
            }
        }
        @media (max-width: 768px) {
            .controls-container {
              
                top: 10px;
                left: 10px;
            }
            .stats-container {
                margin-top: 100px; /* Adjust margin to clear fixed controls */
            }
        }
    </style>
</head>
<body>
 <div id="progress-bar"></div>
    <div class="controls-container">
        <a href="javascript:history.back()" class="back-button">
            ‚Üê Back
        </a>
        <button id="theme-toggle" class="back-button" title="Toggle Dark/Light Mode">
            <span class="mode-icon">‚òÄÔ∏è</span> 
        </button>
    </div>

    <main class="stats-container">
        <h1>Jordan Agriculture Focus and Breakdown</h1>
        
        <div class="filter-bar">
            <a href="#chart-rainfed" class="filter-button">Rainfed vs. Irrigated</a>
            <a href="#chart-regional" class="filter-button">Regional Breakdown</a>
            <a href="#chart-crops" class="filter-button">Principal Crops</a>
        </div>
        
        <p>
            Agriculture in Jordan is shaped by a combination of climate, geography, and limited water resources. The country has diverse agro-ecological zones: the Highlands, where rainfall allows for rainfed cultivation of cereals like wheat and barley; the Jordan Valley, which benefits from irrigation and supports intensive horticulture including vegetables, citrus, and olives; and the Badia (Eastern Steppe), dominated by pastoral systems and limited crop production. Rainfed agriculture covers roughly 60% of cultivated land, whereas irrigated agriculture accounts for about 40%. Despite the challenges of water scarcity, agriculture contributes approximately 4‚Äì5% of Jordan‚Äôs GDP and employs around 3% of the labor force, highlighting its strategic importance for food security and rural livelihoods.
        </p>

        <h2 id="chart-rainfed">1.1 Rainfed vs. Irrigated Area Estimates</h2>
        <div class="chart-description">
            <p>
                This pie chart visualizes the distribution of Jordan's total cultivated area, which is approximately 270,000 ha, based on the irrigation method used. It clearly shows the dominant role of rainfed agriculture in terms of land coverage compared to the intensive, water-dependent irrigated agriculture. This split highlights the environmental constraints and the strategic focus on different farming models across the country. Data reflects the generally accepted 60/40 split.
            </p>
        </div>
        <section class="chart-section">
            <div class="chart-box">
                <h4>Cultivated Area Distribution (60% Rainfed / 40% Irrigated)</h4>
                <canvas id="chart1_RainfedIrrigated" aria-label="Pie chart showing rainfed versus irrigated agriculture area"></canvas>
            </div>
            <div class="text-summary">
                <p>
                    The total cultivated area in Jordan is estimated to be around 270,000 ha (0.27 Mha). This land is divided into two primary types:
                </p>
                <ul>
                    <li>Rainfed Agriculture: Covers <strong>~60%</strong> (‚âà170,000 ha), relying on seasonal rainfall, primarily for cereals and olives in the Highlands.</li>
                    <li>Irrigated Agriculture: Covers <strong>~40%</strong> (‚âà100,000 ha, reflecting the 2019 remote sensing estimate). This is crucial for high-value crops in the Jordan Valley.</li>
                </ul>
                <p style="font-size: 0.85rem; color: var(--accent-color);">
                    *Data sourced from Beithou, N. (2022) and Al-Bakri et al., (2022). Area totals vary due to data collection methods.
                </p>
            </div>
        </section>

        <h2 id="chart-regional">1.2 Regional Agriculture Breakdown</h2>
        <div class="chart-description">
            <p>
                The stacked bar chart below illustrates how irrigation methods differ across Jordan's three major agro-ecological zones: the Highlands, the Jordan Valley, and the Badia. The chart reveals the high dependency of the Jordan Valley on irrigation for its intense cultivation, while the Highlands and the Badia remain overwhelmingly reliant on limited rainfall (rainfed). This visualization emphasizes the regional disparity in water resource management.
            </p>
        </div>
        <section class="chart-section">
            <div class="chart-box">
                <h4>Irrigated vs. Rainfed Split by Region</h4>
                <canvas id="chart2_Regional" aria-label="Stacked bar chart showing the percentage of irrigated and rainfed farming in Highlands, Jordan Valley, and Badia"></canvas>
            </div>
            <div class="text-summary">
                <p>
                    Agricultural practices are largely defined by regional water availability and climate, leading to distinct farming models:
                </p>
                <ul>
                    <li>Jordan Valley: The primary irrigated zone, with <strong>80% irrigation</strong>, specializing in high-value horticulture (vegetables, citrus). It contributes ~61% of national agricultural value-added.</li>
                    <li>Highlands / Mountains: Predominantly <strong>rainfed (~90%)</strong>, supporting olives and winter cereals (wheat, barley) in a Mediterranean-like climate.</li>
                    <li>Badia (Eastern Steppe): Largely pastoral, with <strong>~95% rainfed</strong> land, and very limited crop cultivation due to aridity.</li>
                </ul>
            </div>
        </section>

        <h2 id="chart-crops">1.3 Principal Crops Cultivated</h2>
        <div class="chart-description">
            <p>
                This doughnut chart shows the relative importance and estimated area allocation among Jordan's major crops, utilizing approximated area data. Olives represent the largest single area due to their resilience and long-term economic value. The remaining area is split between high-value, water-intensive crops like Vegetables and Citrus (grown primarily under irrigation), and strategic staple crops like Wheat and Barley (grown primarily rainfed).
            </p>
        </div>
        <section class="chart-section">
            <div class="chart-box">
                <h4>Major Crops Distribution (Based on Cultivated Area/Importance)</h4>
                <canvas id="chart3_Crops" aria-label="Doughnut chart showing the distribution of major crops including olives, vegetables, wheat, and barley"></canvas>
            </div>
            <div class="text-summary">
                <p>
                    Key crops reflect both national food security priorities and economic value:
                </p>
                <ul>
                    <li>Olives: Around <strong>57,000 ha</strong>‚Äîthe most widespread crop by area, critical for livelihoods and oil production.</li>
                    <li>Vegetables: Highly important for local consumption and export, dominating the irrigated area.</li>
                    <li>Wheat & Barley: Key cereals, primarily grown under rainfed conditions to support national food security.</li>
                    <li>Citrus: Significant high-value fruit crop concentrated in irrigated zones.</li>
                </ul>
            </div>
        </section>
        
    </main>

    <script>
    window.addEventListener('scroll', () => {
      const scrollTop = window.pageYOffset;
      const docHeight = document.documentElement.scrollHeight - window.innerHeight;
      const scrollPercent = (scrollTop / docHeight) * 100;
      document.getElementById('progress-bar').style.width = scrollPercent + '%';
    });
        // Store chart instances globally to be able to destroy/re-render
        let charts = {}; 

        // Function to read the current theme colors from CSS variables
        function getChartThemeConfig() {
            const bodyStyle = getComputedStyle(document.body);
            return {
                textColor: bodyStyle.getPropertyValue('--chart-text-color').trim(),
                gridColor: bodyStyle.getPropertyValue('--chart-grid-color').trim(),
            };
        }
        
        // --- Chart.js Data & Configuration ---

        // 1. Rainfed vs. Irrigated Data (Pie Chart) - Based on ~60/40 ratio
        const rainfedIrrigatedData = {
            // Keep simplified labels for cleaner chart presentation
            labels: ["Rainfed Agriculture (~60%)", "Irrigated Agriculture (~40%)"],
            datasets: [{
                data: [60, 40],
                backgroundColor: ["#8BA889", "#49654E"],
                borderWidth: 2
            }]
        };
        
        // 2. Regional Breakdown Data (Stacked Bar Chart)
        const regionalAgricultureData = {
            labels: ["Highlands", "Jordan Valley", "Badia"],
            datasets: [
                {
                    label: "Rainfed (%)",
                    data: [90, 20, 95],
                    backgroundColor: "#8BA889", 
                    borderWidth: 1
                },
                {
                    label: "Irrigated (%)",
                    data: [10, 80, 5],
                    backgroundColor: "#49654E", 
                    borderWidth: 1
                }
            ]
        };

        // 3. Major Crops Data (Doughnut Chart)
        const majorCropsData = {
            // Keep simplified labels for cleaner chart presentation
            labels: ["Olives (57,000 ha)", "Vegetables (High Value)", "Wheat (Staple)", "Barley (Staple)", "Citrus (Irrigated)"],
            datasets: [{
                data: [57, 45, 30, 20, 10], 
                backgroundColor: ["#8BA889", "#49654E", "#253528", "#A3C49B", "#D0E0C0"],
                borderWidth: 2
            }]
        };

        // --- Chart.js Initialization/Re-render Function ---
        function initCharts() {
            // Destroy existing charts if they exist
            Object.values(charts).forEach(chart => {
                // Check if chart object exists and has a destroy method
                if (chart && typeof chart.destroy === 'function') chart.destroy();
            });

            const themeConfig = getChartThemeConfig();
            
            // Global Chart Defaults for current theme
            Chart.defaults.color = themeConfig.textColor;
            Chart.defaults.borderColor = themeConfig.gridColor;
            Chart.defaults.font.family = "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif";


            // Chart 1: Rainfed vs. Irrigated (Pie)
            charts.chart1 = new Chart(document.getElementById("chart1_RainfedIrrigated").getContext("2d"), {
                type: "pie",
                data: rainfedIrrigatedData,
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: { legend: { position: "bottom", labels: { padding: 12 } } },
                    datasets: {
                        pie: { borderColor: themeConfig.gridColor } 
                    }
                }
            });

            // Chart 2: Regional Breakdown (Stacked Bar)
            charts.chart2 = new Chart(document.getElementById("chart2_Regional").getContext("2d"), {
                type: "bar",
                data: regionalAgricultureData,
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    scales: {
                        x: { stacked: true, grid: { color: themeConfig.gridColor } },
                        y: { 
                            stacked: true, 
                            beginAtZero: true, 
                            max: 100, 
                            grid: { color: themeConfig.gridColor },
                            ticks: { callback: (value) => value + "%" }
                        }
                    },
                    plugins: { legend: { position: "top" } }
                }
            });
            
            // Chart 3: Major Crops (Doughnut)
            charts.chart3 = new Chart(document.getElementById("chart3_Crops").getContext("2d"), {
                type: "doughnut",
                data: majorCropsData,
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: { legend: { position: "bottom", labels: { padding: 12 } } },
                    datasets: {
                        doughnut: { borderColor: themeConfig.gridColor }
                    }
                }
            });
        }


        // üí° Theme Switcher Logic
        const themeToggleButton = document.getElementById('theme-toggle');

        function setIcon(isLight) {
            const iconSpan = themeToggleButton.querySelector('.mode-icon');
            iconSpan.textContent = isLight ? 'üåô' : '‚òÄÔ∏è'; // Moon for Light Mode, Sun for Dark Mode
            themeToggleButton.title = isLight ? 'Switch to Dark Mode' : 'Switch to Light Mode';
        }

        function toggleTheme() {
            const isLight = document.body.classList.toggle('light-mode');
            
            if (isLight) {
                localStorage.setItem('theme', 'light');
            } else {
                localStorage.setItem('theme', 'dark');
            }
            setIcon(isLight);
            initCharts(); // Re-render charts to apply new theme colors
        }

        function loadTheme() {
            const savedTheme = localStorage.getItem('theme');
            const prefersLight = window.matchMedia('(prefers-color-scheme: light)').matches;

            // Apply light mode if saved preference is 'light' OR (no saved preference AND system prefers light)
            let isLightMode = false;
            if (savedTheme === 'light') {
                isLightMode = true;
            } else if (savedTheme === null && prefersLight) {
                isLightMode = true;
            }

            if (isLightMode) {
                document.body.classList.add('light-mode');
            } else {
                document.body.classList.remove('light-mode'); // Ensure default is dark mode
            }
            setIcon(isLightMode);
        }

        // --- Event Listeners and Initial Load ---
        document.addEventListener("DOMContentLoaded", () => {
            loadTheme(); // Load theme preference first
            initCharts(); // Initialize charts after theme config is set
            themeToggleButton.addEventListener('click', toggleTheme);
        });
    </script>
</body>
</html>